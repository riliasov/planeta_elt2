# Задача: Миграция БД WebApp из public в отдельную схему

**Контекст:**
В рамках реструктуризации базы данных проекта архитектура была изменена на 4-слойную. Схема `public` очищается. Схемы ETL (`stg_gsheets`, `ops`, `telegram`) уже вынесены.
Нам нужно вынести таблицы веб-приложения (бота) в собственную изолированную схему `webapp`.

**Твоя задача:**
1.  **Создать схему `webapp`** в базе данных.
2.  **Перенести таблицы из `public` в `webapp`**.
    Список таблиц:
    -   `auth_attempts`
    -   `auth_events`
    -   `auth_requests`
    -   `auth_sessions`
    -   `auth_whitelist`
    -   `employees`
    -   `products`
    -   `schedule`
    -   `notification_queue`
    -   `notification_rules`
3.  **Аудит Кода**:
    -   Найти все явные SQL-запросы или ORM-модели, ссылающиеся на `public.*` или просто на имя таблицы без схемы.
    -   Обновить их на `webapp.*`.
4.  **Безопасность (Critical)**:
    -   Проверить RLS политики. При смене схемы они могут слететь или потребовать обновления `search_path`.
    -   Убедиться, что `service_role` имеет доступ к новой схеме.
    -   Явно настроить права для `anon` / `authenticated`, если используются.

**Почему это важно:**
-   Безопасность: изоляция данных приложения от ETL-процессов.
-   Порядок: `public` должен остаться пустым (или содержать только расширения).

**Риски:**
-   Даунтайм бота, если код не обновить *одновременно* с миграцией БД.
-   Ошибки `relation does not exist`, если забыть `search_path` в подключении.

Пожалуйста, выполни этот план и протестируй подключение.
